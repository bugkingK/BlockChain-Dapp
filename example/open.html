
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <link rel="stylesheet" type="text/css" href="main.css">

    <script src="./node_modules/web3/dist/web3.min.js"></script>

</head>
<script>
    if (typeof web3 !== 'undefined') {
        // 현재 사용가능한 Web3 열기, 예를 들면 크롬 metamask
        web3 = new Web3(web3.currentProvider);
    } else {
        //없다면 서버의 Web3 연결하기.
        //자신의 Web3가 로컬에 있다면 http://localhost:8545로 변경하면 됩니다.
        web3 = new Web3(new Web3.providers.HttpProvider("http://bug.lasel.kr:8545"));
    }
    //eth의 기본 지갑은 0번째 지갑입니다.
    web3.eth.defaultAccount = web3.eth.accounts[0];
    // contract로 abi를 정의해 줍니다. 해당 abi는 sol파일을 컴파일 했을 때 추출됩니다.
    var CoursetroContract = web3.eth.contract([
	{
		"constant": false,
		"inputs": [
			{
				"name": "_fName",
				"type": "string"
			},
			{
				"name": "_age",
				"type": "uint256"
			}
		],
		"name": "setInstructor",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "name",
				"type": "string"
			},
			{
				"indexed": false,
				"name": "age",
				"type": "uint256"
			}
		],
		"name": "Instructor",
		"type": "event"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "getInstructor",
		"outputs": [
			{
				"name": "",
				"type": "string"
			},
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	}
]);

    // eth의 컨트렉트 주소를 작성해줍니다. 블록체인에 많은 스마트 컨트렉트들 중에 자신의 컨트렉트를 찾기 위함입니다.
    // 여기까지 설정이 완료된다면 블록체인과 연결된 것입니다. 따라서 solidity파일에 작성한 함수와 변수를 사용할 수 있습니다.
    var BVC = CoursetroContract.at('0xf02018655f54b90fd876486c1d8c350b2c85812b');
    console.log(BVC);

    // 현재 블록에 담겨있는 값을 가져와 json 형태로 변경한 후 출력합니다.
    var json = new Object();
    BVC.getInstructor(function(error, result){
            if(!error)
                {
                    json.result = "success";
                    json.placeID = result[0];
                    json.nn = result[1];
                    json.fefe = result;
                    
                    console.log(JSON.stringify(json));
                }
            else {
            	console.log(error);
                json.result = "fail"

                console.log(JSON.stringify(json));
            }
            document.write(JSON.stringify(json));
        });

</script>
</body>
</html>